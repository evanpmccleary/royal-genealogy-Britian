<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>British Royal Family - Complete Genealogy</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Georgia', serif; background: #f5f0e8; overflow: hidden; }
        
        #header {
            position: fixed; top: 0; left: 0; right: 0;
            background: #2c1810; color: #f5f0e8; padding: 15px 30px;
            z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        #header h1 { font-size: 24px; margin-bottom: 5px; }
        #header .subtitle { font-size: 14px; opacity: 0.8; }
        
        #controls {
            position: fixed; top: 80px; left: 20px;
            background: white; padding: 20px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 100; max-width: 320px;
        }
        #controls h3 { margin-bottom: 15px; color: #2c1810; font-size: 16px; }
        #search-box {
            width: 100%; padding: 10px; border: 2px solid #8B4513;
            border-radius: 4px; font-size: 14px; margin-bottom: 15px;
        }
        .control-section { margin-bottom: 15px; }
        .control-label { display: block; margin-bottom: 8px; font-weight: bold; color: #2c1810; font-size: 13px; }
        button {
            background: #8B4513; color: white; border: none;
            padding: 8px 12px; border-radius: 4px; cursor: pointer;
            margin-right: 5px; margin-bottom: 5px; font-size: 11px;
        }
        button:hover { background: #6d3410; }
        
        #stats {
            position: fixed; top: 80px; right: 20px;
            background: white; padding: 15px 20px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 100;
            font-size: 13px;
        }
        #stats h3 { margin-bottom: 10px; color: #2c1810; font-size: 14px; }
        #stats .stat { margin-bottom: 5px; }
        #stats .stat strong { color: #8B4513; }
        
        #legend {
            position: fixed; bottom: 20px; left: 20px;
            background: white; padding: 15px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 100;
        }
        .legend-item { display: flex; align-items: center; margin-bottom: 8px; font-size: 13px; }
        .legend-color { width: 30px; height: 20px; margin-right: 10px; border-radius: 3px; border: 1px solid #333; }
        
        #tree-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
        
        .node rect { stroke: #333; stroke-width: 2px; cursor: pointer; transition: all 0.2s; }
        .node:hover rect { stroke: #FFD700; stroke-width: 3px; filter: brightness(1.1); }
        .node text { 
            font-family: 'Georgia', serif; font-size: 10px; fill: white; 
            pointer-events: none; text-anchor: middle; 
        }
        .node .name { font-weight: bold; font-size: 11px; }
        .node .dates { font-size: 8px; opacity: 0.9; }
        
        .link-parent { fill: none; stroke: #654321; stroke-width: 2.5px; }
        .link-marriage { fill: none; stroke: #DC143C; stroke-width: 2.5px; stroke-dasharray: 5, 5; }
        
        #person-details {
            position: fixed; top: 200px; right: 20px; width: 350px;
            max-height: 60vh; overflow-y: auto; background: white;
            padding: 25px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 100; display: none;
        }
        #person-details.visible { display: block; }
        #person-details h2 { color: #2c1810; margin-bottom: 15px; font-size: 20px; }
        #person-details .detail-row { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #e0e0e0; }
        #person-details .detail-label { font-weight: bold; color: #8B4513; margin-bottom: 5px; font-size: 12px; }
        #person-details .detail-value { color: #333; font-size: 13px; }
        .close-btn {
            position: absolute; top: 15px; right: 15px; background: transparent;
            color: #8B4513; font-size: 24px; border: none; cursor: pointer;
            padding: 0; width: 30px; height: 30px;
        }
        .close-btn:hover { color: #DC143C; }
        
        #instructions {
            position: fixed; bottom: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.95); padding: 15px;
            border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-size: 12px; max-width: 220px;
        }
        #instructions strong { color: #8B4513; }
    </style>
</head>
<body>
    <div id="header">
        <h1>European Genealogy Database</h1>
        <div class="subtitle">British Royal Family ‚Ä¢ 63 Key Monarchs ‚Ä¢ 519 AD - Present</div>
    </div>
    
    <div id="controls">
        <h3>Search & Navigate</h3>
        <input type="text" id="search-box" placeholder="Search by name...">
        
        <div class="control-section">
            <div class="control-label">Timeline:</div>
            <button onclick="centerOnPerson('cerdic-of-wessex')">Cerdic (First - 519)</button>
            <button onclick="centerOnPerson('charles-iii')">Charles III (Current)</button>
        </div>
        
        <div class="control-section">
            <div class="control-label">Famous Monarchs:</div>
            <button onclick="centerOnPerson('alfred-the-great')">Alfred Great</button>
            <button onclick="centerOnPerson('william-i')">William I</button>
            <button onclick="centerOnPerson('henry-viii')">Henry VIII</button>
            <button onclick="centerOnPerson('victoria')">Victoria</button>
            <button onclick="centerOnPerson('elizabeth-i')">Elizabeth I</button>
        </div>
        
        <div class="control-section">
            <div class="control-label">View:</div>
            <button onclick="resetZoom()">Reset</button>
            <button onclick="fitToScreen()">Fit All</button>
        </div>
    </div>
    
    <div id="stats">
        <h3>Statistics</h3>
        <div class="stat"><strong>Total:</strong> 63 monarchs</div>
        <div class="stat"><strong>Span:</strong> 1,506 years</div>
        <div class="stat"><strong>Dynasties:</strong> 6</div>
        <div class="stat" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 11px;">
            Wessex: 15 ‚Ä¢ Norman: 7<br>
            Plantagenet: 15 ‚Ä¢ Tudor: 6<br>
            Stuart: 7 ‚Ä¢ Windsor: 13
        </div>
    </div>
    
    <div id="legend">
        <strong style="display: block; margin-bottom: 10px;">Dynasties:</strong>
        <div class="legend-item"><div class="legend-color" style="background: #4A90E2;"></div><span>Wessex</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #8B4513;"></div><span>Norman</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #DC143C;"></div><span>Plantagenet</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #D4AF37;"></div><span>Tudor</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #6A0DAD;"></div><span>Stuart</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #000080;"></div><span>Windsor</span></div>
    </div>
    
    <div id="instructions">
        <strong>Controls:</strong><br>
        ‚Ä¢ <strong>Scroll</strong> to zoom<br>
        ‚Ä¢ <strong>Drag</strong> to pan<br>
        ‚Ä¢ <strong>Click</strong> for details<br><br>
        <strong>Lines:</strong> Solid = Parent‚ÜìChild
    </div>
    
    <div id="person-details">
        <button class="close-btn" onclick="closeDetails()">√ó</button>
        <div id="details-content"></div>
    </div>
    
    <svg id="tree-container"></svg>
    
    <script>
        const familyData = {
            nodes: [
        {
                "id": "cerdic-of-wessex",
                "name": "Cerdic of Wessex",
                "birth": 467,
                "death": 534,
                "reign": "519-534",
                "dynasty": "wessex",
                "generation": 0,
                "titles": [
                        "King of Wessex"
                ],
                "x": 500
        },
        {
                "id": "cynric",
                "name": "Cynric",
                "birth": 495,
                "death": 560,
                "reign": "534-560",
                "dynasty": "wessex",
                "generation": 1,
                "titles": [
                        "King of Wessex"
                ],
                "parents": [
                        "cerdic-of-wessex"
                ],
                "x": 500
        },
        {
                "id": "ceawlin",
                "name": "Ceawlin",
                "birth": 520,
                "death": 593,
                "reign": "560-592",
                "dynasty": "wessex",
                "generation": 2,
                "titles": [
                        "King of Wessex"
                ],
                "parents": [
                        "cynric"
                ],
                "x": 500
        },
        {
                "id": "egbert",
                "name": "Egbert",
                "birth": 770,
                "death": 839,
                "reign": "802-839",
                "dynasty": "wessex",
                "generation": 6,
                "titles": [
                        "King of Wessex"
                ],
                "x": 500
        },
        {
                "id": "aethelwulf",
                "name": "\u00c6thelwulf",
                "birth": 795,
                "death": 858,
                "reign": "839-858",
                "dynasty": "wessex",
                "generation": 7,
                "titles": [
                        "King of Wessex"
                ],
                "parents": [
                        "egbert"
                ],
                "x": 500
        },
        {
                "id": "alfred-the-great",
                "name": "Alfred the Great",
                "birth": 849,
                "death": 899,
                "reign": "871-899",
                "dynasty": "wessex",
                "generation": 8,
                "titles": [
                        "King of Wessex"
                ],
                "parents": [
                        "aethelwulf"
                ],
                "x": 500
        },
        {
                "id": "edward-the-elder",
                "name": "Edward the Elder",
                "birth": 874,
                "death": 924,
                "reign": "899-924",
                "dynasty": "wessex",
                "generation": 9,
                "titles": [
                        "King"
                ],
                "parents": [
                        "alfred-the-great"
                ],
                "x": 500
        },
        {
                "id": "aethelstan",
                "name": "\u00c6thelstan",
                "birth": 894,
                "death": 939,
                "reign": "924-939",
                "dynasty": "wessex",
                "generation": 10,
                "titles": [
                        "King of England"
                ],
                "parents": [
                        "edward-the-elder"
                ],
                "x": 500
        },
        {
                "id": "edmund-i",
                "name": "Edmund I",
                "birth": 921,
                "death": 946,
                "reign": "939-946",
                "dynasty": "wessex",
                "generation": 10,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-the-elder"
                ],
                "x": 620
        },
        {
                "id": "edwy",
                "name": "Edwy",
                "birth": 941,
                "death": 959,
                "reign": "955-959",
                "dynasty": "wessex",
                "generation": 11,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edmund-i"
                ],
                "x": 500
        },
        {
                "id": "edgar-the-peaceable",
                "name": "Edgar the Peaceable",
                "birth": 943,
                "death": 975,
                "reign": "959-975",
                "dynasty": "wessex",
                "generation": 11,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edmund-i"
                ],
                "x": 620
        },
        {
                "id": "edward-the-martyr",
                "name": "Edward the Martyr",
                "birth": 962,
                "death": 978,
                "reign": "975-978",
                "dynasty": "wessex",
                "generation": 12,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edgar-the-peaceable"
                ],
                "x": 500
        },
        {
                "id": "aethelred-the-unready",
                "name": "\u00c6thelred II the Unready",
                "birth": 966,
                "death": 1016,
                "reign": "978-1016",
                "dynasty": "wessex",
                "generation": 12,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edgar-the-peaceable"
                ],
                "x": 620
        },
        {
                "id": "edmund-ironside",
                "name": "Edmund II Ironside",
                "birth": 993,
                "death": 1016,
                "reign": "1016",
                "dynasty": "wessex",
                "generation": 13,
                "titles": [
                        "King"
                ],
                "parents": [
                        "aethelred-the-unready"
                ],
                "x": 500
        },
        {
                "id": "edward-the-confessor",
                "name": "Edward the Confessor",
                "birth": 1003,
                "death": 1066,
                "reign": "1042-1066",
                "dynasty": "wessex",
                "generation": 13,
                "titles": [
                        "King"
                ],
                "parents": [
                        "aethelred-the-unready"
                ],
                "x": 620
        },
        {
                "id": "william-i",
                "name": "William I the Conqueror",
                "birth": 1028,
                "death": 1087,
                "reign": "1066-1087",
                "dynasty": "norman",
                "generation": 14,
                "titles": [
                        "King of England"
                ],
                "x": 600
        },
        {
                "id": "matilda-of-flanders",
                "name": "Matilda of Flanders",
                "birth": 1031,
                "death": 1083,
                "reign": null,
                "dynasty": "norman",
                "generation": 14,
                "titles": [
                        "Queen"
                ],
                "spouse": "william-i",
                "x": 720
        },
        {
                "id": "robert-curthose",
                "name": "Robert Curthose",
                "birth": 1051,
                "death": 1134,
                "reign": null,
                "dynasty": "norman",
                "generation": 15,
                "titles": [
                        "Duke of Normandy"
                ],
                "parents": [
                        "william-i",
                        "matilda-of-flanders"
                ],
                "x": 600
        },
        {
                "id": "william-ii",
                "name": "William II Rufus",
                "birth": 1056,
                "death": 1100,
                "reign": "1087-1100",
                "dynasty": "norman",
                "generation": 15,
                "titles": [
                        "King"
                ],
                "parents": [
                        "william-i",
                        "matilda-of-flanders"
                ],
                "x": 720
        },
        {
                "id": "henry-i",
                "name": "Henry I",
                "birth": 1068,
                "death": 1135,
                "reign": "1100-1135",
                "dynasty": "norman",
                "generation": 15,
                "titles": [
                        "King"
                ],
                "parents": [
                        "william-i",
                        "matilda-of-flanders"
                ],
                "x": 840
        },
        {
                "id": "empress-matilda",
                "name": "Empress Matilda",
                "birth": 1102,
                "death": 1167,
                "reign": null,
                "dynasty": "norman",
                "generation": 16,
                "titles": [
                        "Lady of the English"
                ],
                "parents": [
                        "henry-i"
                ],
                "x": 600
        },
        {
                "id": "stephen",
                "name": "Stephen",
                "birth": 1092,
                "death": 1154,
                "reign": "1135-1154",
                "dynasty": "norman",
                "generation": 16,
                "titles": [
                        "King"
                ],
                "x": 720
        },
        {
                "id": "henry-ii",
                "name": "Henry II",
                "birth": 1133,
                "death": 1189,
                "reign": "1154-1189",
                "dynasty": "plantagenet",
                "generation": 17,
                "titles": [
                        "King"
                ],
                "parents": [
                        "empress-matilda"
                ],
                "x": 700
        },
        {
                "id": "richard-i",
                "name": "Richard I Lionheart",
                "birth": 1157,
                "death": 1199,
                "reign": "1189-1199",
                "dynasty": "plantagenet",
                "generation": 18,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-ii"
                ],
                "x": 700
        },
        {
                "id": "john",
                "name": "John",
                "birth": 1166,
                "death": 1216,
                "reign": "1199-1216",
                "dynasty": "plantagenet",
                "generation": 18,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-ii"
                ],
                "x": 820
        },
        {
                "id": "henry-iii",
                "name": "Henry III",
                "birth": 1207,
                "death": 1272,
                "reign": "1216-1272",
                "dynasty": "plantagenet",
                "generation": 19,
                "titles": [
                        "King"
                ],
                "parents": [
                        "john"
                ],
                "x": 700
        },
        {
                "id": "edward-i",
                "name": "Edward I Longshanks",
                "birth": 1239,
                "death": 1307,
                "reign": "1272-1307",
                "dynasty": "plantagenet",
                "generation": 20,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-iii"
                ],
                "x": 700
        },
        {
                "id": "edward-ii",
                "name": "Edward II",
                "birth": 1284,
                "death": 1327,
                "reign": "1307-1327",
                "dynasty": "plantagenet",
                "generation": 21,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-i"
                ],
                "x": 700
        },
        {
                "id": "edward-iii",
                "name": "Edward III",
                "birth": 1312,
                "death": 1377,
                "reign": "1327-1377",
                "dynasty": "plantagenet",
                "generation": 22,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-ii"
                ],
                "x": 700
        },
        {
                "id": "edward-black-prince",
                "name": "Edward the Black Prince",
                "birth": 1330,
                "death": 1376,
                "reign": null,
                "dynasty": "plantagenet",
                "generation": 23,
                "titles": [
                        "Prince of Wales"
                ],
                "parents": [
                        "edward-iii"
                ],
                "x": 700
        },
        {
                "id": "richard-ii",
                "name": "Richard II",
                "birth": 1367,
                "death": 1400,
                "reign": "1377-1399",
                "dynasty": "plantagenet",
                "generation": 24,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-black-prince"
                ],
                "x": 700
        },
        {
                "id": "henry-iv",
                "name": "Henry IV",
                "birth": 1367,
                "death": 1413,
                "reign": "1399-1413",
                "dynasty": "plantagenet",
                "generation": 24,
                "titles": [
                        "King"
                ],
                "x": 820
        },
        {
                "id": "henry-v",
                "name": "Henry V",
                "birth": 1386,
                "death": 1422,
                "reign": "1413-1422",
                "dynasty": "plantagenet",
                "generation": 25,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-iv"
                ],
                "x": 700
        },
        {
                "id": "henry-vi",
                "name": "Henry VI",
                "birth": 1421,
                "death": 1471,
                "reign": "1422-1461, 1470-1471",
                "dynasty": "plantagenet",
                "generation": 26,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-v"
                ],
                "x": 700
        },
        {
                "id": "edward-iv",
                "name": "Edward IV",
                "birth": 1442,
                "death": 1483,
                "reign": "1461-1470, 1471-1483",
                "dynasty": "plantagenet",
                "generation": 26,
                "titles": [
                        "King"
                ],
                "x": 820
        },
        {
                "id": "edward-v",
                "name": "Edward V",
                "birth": 1470,
                "death": 1483,
                "reign": "1483",
                "dynasty": "plantagenet",
                "generation": 27,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-iv"
                ],
                "x": 700
        },
        {
                "id": "richard-iii",
                "name": "Richard III",
                "birth": 1452,
                "death": 1485,
                "reign": "1483-1485",
                "dynasty": "plantagenet",
                "generation": 26,
                "titles": [
                        "King"
                ],
                "x": 940
        },
        {
                "id": "henry-vii",
                "name": "Henry VII",
                "birth": 1457,
                "death": 1509,
                "reign": "1485-1509",
                "dynasty": "tudor",
                "generation": 28,
                "titles": [
                        "King"
                ],
                "x": 800
        },
        {
                "id": "henry-viii",
                "name": "Henry VIII",
                "birth": 1491,
                "death": 1547,
                "reign": "1509-1547",
                "dynasty": "tudor",
                "generation": 29,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-vii"
                ],
                "x": 800
        },
        {
                "id": "edward-vi",
                "name": "Edward VI",
                "birth": 1537,
                "death": 1553,
                "reign": "1547-1553",
                "dynasty": "tudor",
                "generation": 30,
                "titles": [
                        "King"
                ],
                "parents": [
                        "henry-viii"
                ],
                "x": 800
        },
        {
                "id": "lady-jane-grey",
                "name": "Lady Jane Grey",
                "birth": 1537,
                "death": 1554,
                "reign": "1553",
                "dynasty": "tudor",
                "generation": 30,
                "titles": [
                        "Queen (disputed)"
                ],
                "x": 920
        },
        {
                "id": "mary-i",
                "name": "Mary I",
                "birth": 1516,
                "death": 1558,
                "reign": "1553-1558",
                "dynasty": "tudor",
                "generation": 30,
                "titles": [
                        "Queen"
                ],
                "parents": [
                        "henry-viii"
                ],
                "x": 1040
        },
        {
                "id": "elizabeth-i",
                "name": "Elizabeth I",
                "birth": 1533,
                "death": 1603,
                "reign": "1558-1603",
                "dynasty": "tudor",
                "generation": 30,
                "titles": [
                        "Queen"
                ],
                "parents": [
                        "henry-viii"
                ],
                "x": 1160
        },
        {
                "id": "james-i",
                "name": "James I (VI of Scotland)",
                "birth": 1566,
                "death": 1625,
                "reign": "1603-1625",
                "dynasty": "stuart",
                "generation": 31,
                "titles": [
                        "King of England & Scotland"
                ],
                "x": 900
        },
        {
                "id": "charles-i",
                "name": "Charles I",
                "birth": 1600,
                "death": 1649,
                "reign": "1625-1649",
                "dynasty": "stuart",
                "generation": 32,
                "titles": [
                        "King"
                ],
                "parents": [
                        "james-i"
                ],
                "x": 900
        },
        {
                "id": "charles-ii",
                "name": "Charles II",
                "birth": 1630,
                "death": 1685,
                "reign": "1660-1685",
                "dynasty": "stuart",
                "generation": 33,
                "titles": [
                        "King"
                ],
                "parents": [
                        "charles-i"
                ],
                "x": 900
        },
        {
                "id": "james-ii",
                "name": "James II",
                "birth": 1633,
                "death": 1701,
                "reign": "1685-1688",
                "dynasty": "stuart",
                "generation": 33,
                "titles": [
                        "King"
                ],
                "parents": [
                        "charles-i"
                ],
                "x": 1020
        },
        {
                "id": "mary-ii",
                "name": "Mary II",
                "birth": 1662,
                "death": 1694,
                "reign": "1689-1694",
                "dynasty": "stuart",
                "generation": 34,
                "titles": [
                        "Queen"
                ],
                "parents": [
                        "james-ii"
                ],
                "x": 900
        },
        {
                "id": "william-iii",
                "name": "William III",
                "birth": 1650,
                "death": 1702,
                "reign": "1689-1702",
                "dynasty": "stuart",
                "generation": 34,
                "titles": [
                        "King"
                ],
                "x": 1020
        },
        {
                "id": "anne",
                "name": "Anne",
                "birth": 1665,
                "death": 1714,
                "reign": "1702-1714",
                "dynasty": "stuart",
                "generation": 34,
                "titles": [
                        "Queen"
                ],
                "parents": [
                        "james-ii"
                ],
                "x": 1140
        },
        {
                "id": "george-i",
                "name": "George I",
                "birth": 1660,
                "death": 1727,
                "reign": "1714-1727",
                "dynasty": "windsor",
                "generation": 35,
                "titles": [
                        "King"
                ],
                "x": 1000
        },
        {
                "id": "george-ii",
                "name": "George II",
                "birth": 1683,
                "death": 1760,
                "reign": "1727-1760",
                "dynasty": "windsor",
                "generation": 36,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-i"
                ],
                "x": 1000
        },
        {
                "id": "george-iii",
                "name": "George III",
                "birth": 1738,
                "death": 1820,
                "reign": "1760-1820",
                "dynasty": "windsor",
                "generation": 37,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-ii"
                ],
                "x": 1000
        },
        {
                "id": "george-iv",
                "name": "George IV",
                "birth": 1762,
                "death": 1830,
                "reign": "1820-1830",
                "dynasty": "windsor",
                "generation": 38,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-iii"
                ],
                "x": 1000
        },
        {
                "id": "william-iv",
                "name": "William IV",
                "birth": 1765,
                "death": 1837,
                "reign": "1830-1837",
                "dynasty": "windsor",
                "generation": 38,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-iii"
                ],
                "x": 1120
        },
        {
                "id": "victoria",
                "name": "Victoria",
                "birth": 1819,
                "death": 1901,
                "reign": "1837-1901",
                "dynasty": "windsor",
                "generation": 39,
                "titles": [
                        "Queen"
                ],
                "x": 1000
        },
        {
                "id": "edward-vii",
                "name": "Edward VII",
                "birth": 1841,
                "death": 1910,
                "reign": "1901-1910",
                "dynasty": "windsor",
                "generation": 40,
                "titles": [
                        "King"
                ],
                "parents": [
                        "victoria"
                ],
                "x": 1000
        },
        {
                "id": "george-v",
                "name": "George V",
                "birth": 1865,
                "death": 1936,
                "reign": "1910-1936",
                "dynasty": "windsor",
                "generation": 41,
                "titles": [
                        "King"
                ],
                "parents": [
                        "edward-vii"
                ],
                "x": 1000
        },
        {
                "id": "edward-viii",
                "name": "Edward VIII",
                "birth": 1894,
                "death": 1972,
                "reign": "1936",
                "dynasty": "windsor",
                "generation": 42,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-v"
                ],
                "x": 1000
        },
        {
                "id": "george-vi",
                "name": "George VI",
                "birth": 1895,
                "death": 1952,
                "reign": "1936-1952",
                "dynasty": "windsor",
                "generation": 42,
                "titles": [
                        "King"
                ],
                "parents": [
                        "george-v"
                ],
                "x": 1120
        },
        {
                "id": "elizabeth-ii",
                "name": "Elizabeth II",
                "birth": 1926,
                "death": 2022,
                "reign": "1952-2022",
                "dynasty": "windsor",
                "generation": 43,
                "titles": [
                        "Queen"
                ],
                "parents": [
                        "george-vi"
                ],
                "x": 1000
        },
        {
                "id": "charles-iii",
                "name": "Charles III",
                "birth": 1948,
                "death": null,
                "reign": "2022-",
                "dynasty": "windsor",
                "generation": 44,
                "titles": [
                        "King"
                ],
                "parents": [
                        "elizabeth-ii"
                ],
                "x": 1000
        },
        {
                "id": "william-prince-of-wales",
                "name": "William, Prince of Wales",
                "birth": 1982,
                "death": null,
                "reign": null,
                "dynasty": "windsor",
                "generation": 45,
                "titles": [
                        "Prince of Wales"
                ],
                "parents": [
                        "charles-iii"
                ],
                "x": 1000
        }
]
        };
        
        const dynastyColors = {
            wessex: "#4A90E2",
            norman: "#8B4513",
            plantagenet: "#DC143C",
            tudor: "#D4AF37",
            stuart: "#6A0DAD",
            windsor: "#000080"
        };
        
        let svg, g, zoom;
        
        function initializeVisualization() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            svg = d3.select('#tree-container').attr('width', width).attr('height', height);
            zoom = d3.zoom().scaleExtent([0.1, 4]).on('zoom', (event) => { g.attr('transform', event.transform); });
            svg.call(zoom);
            g = svg.append('g');
            
            const verticalSpacing = 100;
            familyData.nodes.forEach(person => {
                person.y = person.generation * verticalSpacing + 150;
                person.color = dynastyColors[person.dynasty] || "#999";
            });
            
            // Draw parent-child links
            const parentLinks = g.append('g').selectAll('path').data(
                familyData.nodes.filter(n => n.parents && n.parents.length > 0)
                    .flatMap(child => {
                        const primaryParent = familyData.nodes.find(n => n.id === child.parents[0]);
                        if (!primaryParent) return [];
                        return [{source: primaryParent, target: child}];
                    })
            ).join('path')
                .attr('class', 'link-parent')
                .attr('d', d => {
                    const midY = (d.source.y + d.target.y) / 2;
                    return `M${d.source.x},${d.source.y + 25} 
                            L${d.source.x},${midY} 
                            L${d.target.x},${midY} 
                            L${d.target.x},${d.target.y - 25}`;
                });
            
            // Draw marriage links
            const marriageLinks = g.append('g').selectAll('path').data(
                familyData.nodes.filter(n => n.spouse).map(person => ({
                    source: person,
                    target: familyData.nodes.find(n => n.id === person.spouse)
                })).filter(d => d.source && d.target)
            ).join('path')
                .attr('class', 'link-marriage')
                .attr('d', d => `M${d.source.x + 55},${d.source.y} L${d.target.x - 55},${d.target.y}`);
            
            // Draw nodes
            const node = g.append('g').selectAll('g').data(familyData.nodes).join('g')
                .attr('class', 'node')
                .attr('transform', d => `translate(${d.x},${d.y})`)
                .on('click', (event, d) => showPersonDetails(d));
            
            node.append('rect').attr('width', 110).attr('height', 50).attr('x', -55).attr('y', -25)
                .attr('rx', 5).attr('fill', d => d.color);
            
            node.append('text').attr('class', 'name').attr('y', -8).text(d => {
                if (d.name.length > 18) return d.name.substring(0, 16) + '...';
                return d.name;
            });
            node.append('text').attr('class', 'dates').attr('y', 4)
                .text(d => { 
                    if (d.birth && d.death) return `${d.birth}-${d.death}`;
                    if (d.birth && !d.death) return `b.${d.birth}`;
                    return '';
                });
            node.append('text').attr('class', 'dates').attr('y', 14)
                .text(d => d.reign ? `r.${d.reign}` : '');
            
            setTimeout(() => fitToScreen(), 500);
        }
        
        function showPersonDetails(person) {
            const panel = document.getElementById('person-details');
            const content = document.getElementById('details-content');
            const wikiName = person.name.replace(/ /g, '_');
            const wikiUrl = `https://en.wikipedia.org/wiki/${wikiName}`;
            
            let html = `<h2>${person.name}</h2>`;
            
            if (person.birth || person.death) {
                html += `<div class="detail-row">
                    <div class="detail-label">Born:</div><div class="detail-value">${person.birth || 'Unknown'}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Died:</div><div class="detail-value">${person.death || 'Living'}</div>
                </div>`;
            }
            
            if (person.reign) {
                html += `<div class="detail-row"><div class="detail-label">Reign:</div><div class="detail-value">${person.reign}</div></div>`;
            }
            
            html += `<div class="detail-row">
                <div class="detail-label">Dynasty:</div>
                <div class="detail-value" style="text-transform: capitalize;">${person.dynasty}</div>
            </div>`;
            
            if (person.titles && person.titles.length > 0) {
                html += `<div class="detail-row">
                    <div class="detail-label">Titles:</div>
                    <div class="detail-value">${person.titles.join(', ')}</div>
                </div>`;
            }
            
            html += `<div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #8B4513;">
                <a href="${wikiUrl}" target="_blank" style="display: block; background: #8B4513; color: white; padding: 12px 20px; text-align: center; text-decoration: none; border-radius: 5px; font-weight: bold; margin-bottom: 10px; font-size: 13px;">üìñ Wikipedia</a>
                <button onclick="centerOnPerson('${person.id}')" style="width: 100%; background: #4A90E2; padding: 10px;">üîç Center</button>
            </div>`;
            
            content.innerHTML = html;
            panel.classList.add('visible');
        }
        
        function closeDetails() { document.getElementById('person-details').classList.remove('visible'); }
        
        function centerOnPerson(personId) {
            const person = familyData.nodes.find(n => n.id === personId);
            if (!person) return;
            const transform = d3.zoomIdentity
                .translate(window.innerWidth / 2, window.innerHeight / 2)
                .scale(1.2)
                .translate(-person.x, -person.y);
            svg.transition().duration(750).call(zoom.transform, transform);
        }
        
        function resetZoom() { svg.transition().duration(750).call(zoom.transform, d3.zoomIdentity); }
        
        function fitToScreen() {
            const bounds = g.node().getBBox();
            const width = window.innerWidth, height = window.innerHeight;
            const midX = bounds.x + bounds.width / 2, midY = bounds.y + bounds.height / 2;
            const scale = 0.8 / Math.max(bounds.width / width, bounds.height / height);
            const transform = d3.zoomIdentity
                .translate(width / 2, height / 2)
                .scale(scale)
                .translate(-midX, -midY);
            svg.transition().duration(750).call(zoom.transform, transform);
        }
        
        document.getElementById('search-box').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            if (!query) return;
            const matches = familyData.nodes.filter(n => 
                n.name.toLowerCase().includes(query)
            );
            if (matches.length > 0) {
                centerOnPerson(matches[0].id);
                showPersonDetails(matches[0]);
            }
        });
        
        initializeVisualization();
        console.log('‚úÖ Loaded 63 monarchs spanning 1,506 years');
    </script>
</body>
</html>